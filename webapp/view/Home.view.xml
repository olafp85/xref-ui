<mvc:View controllerName="xref.controller.Home"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:core="sap.ui.core"
    xmlns="sap.m"
    core:require="{ formatMessage: 'sap/base/strings/formatMessage' }">

    <Page title="{i18n>appTitle}"
        class="sapUiContentPadding sapUiResponsivePadding--header">

        <headerContent>
            <Text text="{view>/version}"></Text>
            <Button text="{i18n>login}"
                press="onLogin"
                visible="{view>/action/login}"></Button>
            <Avatar displaySize="XS"
                press="onUser"
                visible="{view>/action/logout}">
                <dependents>
                    <core:Fragment type="XML"
                        fragmentName="xref.view.fragment.User" />
                </dependents>
            </Avatar>
        </headerContent>

        <content>
            <Table id="table"
                width="auto"
                class="sapUiResponsiveMargin"
                autoPopinMode="true"
                items="{
		        	path: 'xrefs>/',
		        	sorter: { path: 'name' }
	        	}"
                fixedLayout="false"
                sticky="ColumnHeaders"
                hiddenInPopin="Low"
                mode="{view>/table/mode}"
                delete="onItemDelete"
                updateFinished="onUpdateFinished"
                busyIndicatorDelay="0">

                <headerToolbar>
                    <OverflowToolbar>
                        <Title text="{
                            parts: [
                                'i18n>items',
                                'view>/table/count'
                            ],
                            formatter: 'formatMessage'
                        }"/>
                        <ToolbarSpacer/>
                        <SearchField liveChange="onSearch">
                            <layoutData>
                                <OverflowToolbarLayoutData maxWidth="15rem"
                                    shrinkable="true"
                                    priority="NeverOverflow"/>
                            </layoutData>
                        </SearchField>
                        <OverflowToolbarButton icon="sap-icon://sort"
                            text="{i18n-sap.ui.core>Icon.sort}"
                            press="onSort">
                            <layoutData>
                                <OverflowToolbarLayoutData group="1" />
                            </layoutData>
                        </OverflowToolbarButton>
                        <OverflowToolbarButton icon="sap-icon://upload"
                            text="{i18n-sap.ui.core>Icon.upload}"
                            press="onUpload"
                            visible="{view>/action/upload}">
                            <dependents>
                                <core:Fragment type="XML"
                                    fragmentName="xref.view.fragment.Upload" />
                            </dependents>
                            <layoutData>
                                <OverflowToolbarLayoutData group="1" />
                            </layoutData>
                        </OverflowToolbarButton>
                        <OverflowToolbarButton icon="sap-icon://display"
                            text="{i18n-sap.ui.core>Icon.display}"
                            press="onDisplay"
                            visible="{view>/action/display}">
                            <layoutData>
                                <OverflowToolbarLayoutData group="1" />
                            </layoutData>
                        </OverflowToolbarButton>
                        <OverflowToolbarButton icon="sap-icon://edit"
                            text="{i18n-sap.m>SEMANTIC_CONTROL_EDIT}"
                            press="onEdit"
                            visible="{view>/action/edit}">
                            <layoutData>
                                <OverflowToolbarLayoutData group="1" />
                            </layoutData>
                        </OverflowToolbarButton>
                    </OverflowToolbar>
                </headerToolbar>

                <columns>
                    <Column>
                        <Text text="{i18n>type}" />
                    </Column>
                    <Column>
                        <Text text="{i18n>name}" />
                    </Column>
                    <Column importance="Low">
                        <Text text="{i18n>system}" />
                    </Column >
                    <Column importance="Low"
                        hAlign="Right">
                        <Text text="{i18n>date}" />
                    </Column>
                </columns>

                <items>
                    <ColumnListItem type="{view>/columnListItem/type}"
                        press="onItemPress">
                        <cells>
                            <Text text="{= ${xrefs>type}.toLowerCase()}" />
                            <Text text="{xrefs>name}" />
                            <Text text="{xrefs>system}" />
                            <Text text="{
                                path: 'xrefs>date',
                                type: 'sap.ui.model.type.Date',
                                formatOptions: {
                                    source: { pattern: 'yyyy-MM-dd' },
                                    relative: 'true', 
                                    relativeRange: [-2, 2],
                                    style: 'long'
                                }
                            }" />
                        </cells>
                    </ColumnListItem>
                </items>

            </Table>
        </content>

    </Page>
</mvc:View>
